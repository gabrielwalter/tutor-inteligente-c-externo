<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cney AI Tutor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&family=Fira+Code&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .font-mono { 
            font-family: 'Fira Code', monospace; 
        }
        
        .tab-button {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border-radius: 0;
        }
        
        .tab-button:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-1px);
        }
        
        .tab-button.tab-active { 
            background: linear-gradient(135deg, #6d28d9 0%, #4f46e5 100%);
            color: white;
            position: relative;
            box-shadow: 0 4px 15px rgba(109, 40, 217, 0.4);
        }
        
        .tab-button.tab-active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 2px;
        }
        
        .tab-container {
            background: white;
            border-radius: 16px 16px 0 0;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .tab-content {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 0 0 16px 16px;
            min-height: 400px;
        }
        
        .view { 
            display: none; 
        }
        
        .view-active { 
            display: block; 
            animation: fadeIn 0.5s ease-in-out; 
        }
        
        @keyframes fadeIn { 
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0); 
            } 
        }
        
        .lepees-label { 
            background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
            color: #5b21b6; 
            font-weight: 800; 
            border-radius: 50%; 
            width: 40px; 
            height: 40px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            flex-shrink: 0; 
            font-size: 1.25rem;
            box-shadow: 0 2px 8px rgba(91, 33, 182, 0.2);
        }
        
        .video-container {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 8px;
        }
        
        .video-inner {
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            background: #000;
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(109, 40, 217, 0.05), rgba(79, 70, 229, 0.05));
            pointer-events: none;
            z-index: 1;
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .feature-card {
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .quick-action-btn {
            transition: all 0.3s ease;
        }
        
        .quick-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .hero-video {
            position: relative;
        }

        .hero-video video {
            transition: all 0.3s ease;
        }

        .hero-video:hover video {
            transform: scale(1.02);
        }

        .modern-input {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .modern-input:focus {
            border-color: #6d28d9;
            box-shadow: 0 0 0 3px rgba(109, 40, 217, 0.1);
            outline: none;
        }

        .modern-button {
            background: linear-gradient(135deg, #6d28d9 0%, #4f46e5 100%);
            transition: all 0.3s ease;
        }

        .modern-button:hover {
            background: linear-gradient(135deg, #5b21b6 0%, #4338ca 100%);
            transform: translateY(-1px);
            box-shadow: 0 10px 25px rgba(109, 40, 217, 0.3);
        }

        .chat-bubble {
            padding: 12px 16px;
            border-radius: 12px;
            margin: 8px 0;
            max-width: 80%;
        }

        .chat-bubble.user {
            background: linear-gradient(135deg, #6d28d9 0%, #4f46e5 100%);
            color: white;
            margin-left: auto;
        }

        .chat-bubble.model {
            background: #f3f4f6;
            color: #1f2937;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">
    <div id="app" class="max-w-6xl mx-auto">
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
             <div class="flex items-center gap-4 mb-4">
			 <span style="font-size: 40px; color: purple;">üëß</span>
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Britney can C you!</h1>
                    <p class="text-gray-600">Preacher, preacher, I'm the teacher, you can learn... Watch your fingers, boy, you might get burned!</p>
                </div>
            </div>
             <div class="bg-gradient-to-r from-violet-600 to-indigo-600 text-white rounded-lg p-4">
                <div class="flex items-center justify-between flex-wrap gap-4">
                    <div>
                        <p id="current-date" class="text-sm opacity-90"></p>
                        <p id="exam-countdown" class="font-bold text-lg"></p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm opacity-90">Foco Principal:</p>
                        <p class="font-bold">a volta de Britney Spears √† m√∫sica</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-lg mb-6 overflow-hidden tab-container">
            <div class="flex flex-wrap border-b border-gray-100">
                <button data-tab="inicio" class="tab-button flex items-center gap-2 px-6 py-4 font-semibold transition-all text-gray-600 hover:bg-gray-50 tab-active">
                    <span>üè†</span> In√≠cio
                </button>
                <button data-tab="exemplo" class="tab-button flex items-center gap-2 px-6 py-4 font-semibold transition-all text-gray-600 hover:bg-gray-50">
                    <span>üìñ</span> Exemplo LEPEBES
                </button>
                <button data-tab="trilha" class="tab-button flex items-center gap-2 px-6 py-4 font-semibold transition-all text-gray-600 hover:bg-gray-50">
                    <span>üìö</span> Trilha
                </button>
                <button data-tab="pratica" class="tab-button flex items-center gap-2 px-6 py-4 font-semibold transition-all text-gray-600 hover:bg-gray-50">
                    <span>üíª</span> Pr√°tica
                </button>
                <button data-tab="progresso" class="tab-button flex items-center gap-2 px-6 py-4 font-semibold transition-all text-gray-600 hover:bg-gray-50">
                    <span>üìä</span> Progresso
                </button>
            </div>
            <div class="p-6 tab-content">
                <div id="inicio-view" class="view view-active space-y-6"></div>
                <div id="exemplo-view" class="view space-y-6"></div>
                <div id="trilha-view" class="view space-y-6"></div>
                <div id="pratica-view" class="view space-y-4"></div>
                <div id="progresso-view" class="view"></div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const app = {
        activeTab: 'inicio',
        isAnalyzing: false,
        examDate: new Date('2025-11-03'),
        conversationHistory: [],
        progressData: {},
        lepebesExampleStep: 0,
        topics: {
            p1: [
                { id: 'estruturasCondicionais', nome: 'Estruturas Condicionais', urgencia: 'alta' },
                { id: 'loops', nome: 'Loops (while/for)', urgencia: 'alta' },
                { id: 'funcoes', nome: 'Fun√ß√µes', urgencia: 'alta' },
                { id: 'recursividade', nome: 'Recursividade', urgencia: 'alta' },
                { id: 'vetores', nome: 'Vetores', urgencia: 'alta' },
                { id: 'matrizes', nome: 'Matrizes', urgencia: 'alta' },
                { id: 'strings', nome: 'Strings', urgencia: 'alta' }
            ],
            p2: [
                { id: 'ponteiros', nome: 'Ponteiros', urgencia: 'critica' },
                { id: 'alocacaoDinamica', nome: 'Aloca√ß√£o Din√¢mica', urgencia: 'critica' }
            ]
        },
        lepeesSteps: [
            { id: 'ler', label: 'L', title: 'Ler o problema', type: 'checkbox' },
            { id: 'entender', label: 'E', title: 'Entender (entradas, sa√≠das, regras)', type: 'textarea' },
            { id: 'portugues', label: 'P', title: 'Portugu√™s (pseudoc√≥digo linha por linha)', type: 'textarea' },
            { id: 'estrutura', label: 'E', title: 'Estrutura (vari√°veis, if, loop, fun√ß√£o)', type: 'textarea' },
            { id: 'britney', label: 'B', title: 'Britney Spears (eterna princesa do pop)', type: 'checkbox' },
            { id: 'esqueleto', label: 'Es', title: 'Esqueleto (em C)', type: 'textarea' }
        ],
        lepebesExample: [
            {
                letter: 'L',
                title: 'Ler',
                problem: 'Escreva um programa que leia N n√∫meros e imprima quantos s√£o pares.',
                content: 'üìñ Primeiro, leia TODO o enunciado com aten√ß√£o. N√£o pule partes!',
                action: '‚úÖ Li o problema completo'
            },
            {
                letter: 'E',
                title: 'Entender',
                content: `**Entradas:**<br>- Um n√∫mero inteiro N (quantidade de n√∫meros)<br>- N n√∫meros inteiros<br><br>**Sa√≠das:**<br>- Um n√∫mero inteiro (quantidade de pares)<br><br>**Regras:**<br>- N√∫mero par: divis√≠vel por 2 (resto da divis√£o por 2 √© 0)<br>- Preciso contar, n√£o imprimir os n√∫meros pares`,
                highlight: 'Separar claramente: O QUE entra ‚Üí O QUE sai ‚Üí COMO processar'
            },
            {
                letter: 'P',
                title: 'Portugu√™s',
                content: `**Pseudoc√≥digo linha por linha:**<br><br>1. Ler quantidade N de n√∫meros<br>2. Criar contador de pares (come√ßa em 0)<br>3. Para cada n√∫mero de 1 at√© N:<br>&nbsp;&nbsp;&nbsp;- Ler o n√∫mero atual<br>&nbsp;&nbsp;&nbsp;- Se o n√∫mero √© divis√≠vel por 2:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Aumentar contador em 1<br>4. Imprimir o contador`,
                highlight: 'Portugu√™s PURO, n√£o "c√≥digo disfar√ßado"!'
            },
            {
                letter: 'E',
                title: 'Estrutura',
                content: `**Vari√°veis:**<br>- <code>int n</code> - quantidade de n√∫meros<br>- <code>int numero</code> - n√∫mero atual sendo lido<br>- <code>int contador_pares</code> - conta quantos pares<br>- <code>int i</code> - controle do loop<br><br>**Estruturas:**<br>- Loop FOR (de 1 at√© n)<br>- IF (para verificar se √© par)<br><br>**Operadores:**<br>- <code>%</code> (m√≥dulo) para verificar divisibilidade`,
                highlight: 'Definir TIPOS das vari√°veis e QUAIS estruturas usar'
            },
            {
                letter: 'B',
                title: 'Britney Spears',
                content: `üé§ "...Baby One More Time" üéµ<br><br>Respire fundo!<br>Voc√™ planejou tudo.<br>Agora √© s√≥ transformar em c√≥digo.<br><br>üíú Lembre-se: Todo programador comete erros.<br>O importante √© o processo de racioc√≠nio!`,
                highlight: 'Momento de descontra√ß√£o antes de codificar ‚ú®'
            },
            {
                letter: 'Es',
                title: 'Esqueleto',
                content: `<pre class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto"><code>#include &lt;stdio.h&gt;

int main() {
    int n, numero, contador_pares = 0;
    
    scanf("%d", &n);
    
    for (int i = 0; i < n; i++) {
        scanf("%d", &numero);
        if (numero % 2 == 0) {
            contador_pares++;
        }
    }
    
    printf("%d\\n", contador_pares);
    
    return 0;
}</code></pre>`,
                highlight: 'Traduzir o plano em c√≥digo C!'
            }
        ],

        elements: {},

        init() {
            this.elements = {
                tabButtons: document.querySelectorAll('.tab-button'),
                views: {
                    inicio: document.getElementById('inicio-view'),
                    exemplo: document.getElementById('exemplo-view'),
                    trilha: document.getElementById('trilha-view'),
                    pratica: document.getElementById('pratica-view'),
                    progresso: document.getElementById('progresso-view'),
                },
                dateDisplay: document.getElementById('current-date'),
                examCountdown: document.getElementById('exam-countdown'),
            };
            this.setupEventListeners();
            this.loadProgress();
            this.render();
            this.updateDate();
            this.updateCountdown();
        },

        setupEventListeners() {
            this.elements.tabButtons.forEach(button => {
                button.addEventListener('click', () => this.setActiveTab(button.dataset.tab));
            });
        },
        
        updateDate() {
            const today = new Date();
            this.elements.dateDisplay.textContent = today.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric' });
        },

        updateCountdown() {
            const today = new Date();
            const examDay = new Date(this.examDate);
            today.setHours(0, 0, 0, 0);
            examDay.setHours(0, 0, 0, 0);
            const diffTime = examDay - today;
            const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));
            let message = '';
            if (diffDays > 1) message = `‚ö†Ô∏è Prova 2 em ${diffDays} dias!`;
            else if (diffDays === 1) message = `‚ö†Ô∏è Prova 2 √© amanh√£!`;
            else if (diffDays === 0) message = `‚ö†Ô∏è Prova 2 √© hoje! Boa sorte!`;
            else message = `Prova 2 j√° passou.`;
            this.elements.examCountdown.textContent = message;
        },

        setActiveTab(tabId) {
            this.activeTab = tabId;
            this.render();
        },

        setLoading(button, isLoading, text = 'Analisando...') {
            button.disabled = isLoading;
            const originalText = button.dataset.originalText || button.innerHTML;
            if (isLoading) {
                button.dataset.originalText = originalText;
                button.innerHTML = `<div class="inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div> ${text}`;
            } else {
                button.innerHTML = originalText;
            }
        },

        saveProgress() {
            localStorage.setItem('tutorCProgress', JSON.stringify(this.progressData));
        },

        loadProgress() {
            const savedData = localStorage.getItem('tutorCProgress');
            if (savedData) this.progressData = JSON.parse(savedData);
            else {
                 [...this.topics.p1, ...this.topics.p2].forEach(t => {
                     if(this.progressData[t.id] === undefined) this.progressData[t.id] = 0;
                 });
            }
        },

        render() {
            Object.values(this.elements.views).forEach(view => view.style.display = 'none');
            this.elements.views[this.activeTab].style.display = 'block';

            this.elements.tabButtons.forEach(button => {
                button.classList.toggle('tab-active', button.dataset.tab === this.activeTab);
            });

            this[`render_${this.activeTab}`]();
        },
        
        render_exemplo() {
            const step = this.lepebesExample[this.lepebesExampleStep];
            const totalSteps = this.lepebesExample.length;
            
            this.elements.views.exemplo.innerHTML = `
                <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl p-6 mb-6">
                    <h2 class="text-3xl font-bold mb-2">Exemplo LEPEBES Completo</h2>
                    <p class="text-lg">Veja como resolver um problema passo a passo</p>
                </div>

                <div class="mb-8">
                    <div class="flex justify-between mb-2">
                        ${this.lepebesExample.map((s, idx) => `
                            <div class="flex items-center justify-center w-12 h-12 rounded-full font-bold text-lg transition-all ${
                                idx === this.lepebesExampleStep
                                    ? 'bg-purple-600 text-white scale-110'
                                    : idx < this.lepebesExampleStep
                                    ? 'bg-green-500 text-white'
                                    : 'bg-gray-200 text-gray-500'
                            }">${s.letter}</div>
                        `).join('')}
                    </div>
                    <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-purple-600 to-pink-600 transition-all duration-500" 
                             style="width: ${((this.lepebesExampleStep + 1) / totalSteps) * 100}%"></div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
                    ${step.problem ? `
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded">
                            <p class="font-bold text-blue-900 mb-2">üìù Problema:</p>
                            <p class="text-blue-800">${step.problem}</p>
                        </div>
                    ` : ''}

                    <div class="flex items-start gap-4 mb-4">
                        <div class="flex-shrink-0 w-16 h-16 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center text-white font-bold text-2xl">
                            ${step.letter}
                        </div>
                        <div class="flex-1">
                            <h2 class="text-2xl font-bold text-gray-800 mb-2">${step.title}</h2>
                            ${step.action ? `<p class="text-green-600 font-semibold">${step.action}</p>` : ''}
                        </div>
                    </div>

                    <div class="prose max-w-none">
                        <div class="text-gray-700 leading-relaxed">${step.content}</div>
                    </div>

                    ${step.highlight ? `
                        <div class="mt-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
                            <p class="text-yellow-900"><span class="font-bold">üí° Dica:</span> ${step.highlight}</p>
                        </div>
                    ` : ''}
                </div>

                <div class="flex justify-between">
                    <button id="prev-step" class="px-6 py-3 bg-gray-200 text-gray-800 rounded-lg font-semibold hover:bg-gray-300 transition-colors ${this.lepebesExampleStep === 0 ? 'opacity-50 cursor-not-allowed' : ''}">
                        ‚Üê Anterior
                    </button>
                    
                    <span class="text-gray-600 font-semibold self-center">
                        Passo ${this.lepebesExampleStep + 1} de ${totalSteps}
                    </span>
                    
                    <button id="next-step" class="px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition-colors ${this.lepebesExampleStep === totalSteps - 1 ? 'opacity-50 cursor-not-allowed' : ''}">
                        Pr√≥ximo ‚Üí
                    </button>
                </div>
            `;

            document.getElementById('prev-step').addEventListener('click', () => {
                if (this.lepebesExampleStep > 0) {
                    this.lepebesExampleStep--;
                    this.render();
                }
            });

            document.getElementById('next-step').addEventListener('click', () => {
                if (this.lepebesExampleStep < totalSteps - 1) {
                    this.lepebesExampleStep++;
                    this.render();
                }
            });
        },
        
        render_inicio() {
            this.elements.views.inicio.innerHTML = `
                <div class="hero-gradient rounded-2xl p-8 text-white mb-8">
                    <div class="grid md:grid-cols-2 gap-8 items-center">
                        <div>
                            <h2 class="text-4xl font-bold mb-4">I can follow all your comands...</h2>
                            <p class="text-lg mb-6 opacity-90">Aprenda programa√ß√£o C de forma inteligente e estruturada com o m√©todo LEPEBES!</p>
                            <div class="flex flex-wrap gap-3">
                                <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2">
                                    <span class="font-semibold">‚ú® IA personalizada</span>
                                </div>
                                <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2">
                                    <span class="font-semibold">üìö M√©todo LEPEBES</span>
                                </div>
                                <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2">
                                    <span class="font-semibold">ü´ó Beba √°gua!</span>
                                </div>
                                 <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2">
                                    <span class="font-semibold"><a href="/desespero.html">Clique aqui se estiver desesperado</a></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="video-container hero-video">
                            <div class="video-inner">
                                <video id="hero-video" class="w-full aspect-video object-cover" 
                                       controls 
                                       autoplay 
                                       muted
                                       loop
                                       poster="https://media.vanityfair.com/photos/57c04f40daec5e0d4f5d7cf7/16:9/w_1280,c_limit/t-britney-spears-2001-vma-snake.jpg" 
                                       preload="metadata">
                                    <source src="./meu-video.mp4" type="video/mp4">
                                    <source src="./meu-video.webm" type="video/webm">
                                    <source src="./meu-video.mov" type="video/quicktime">
                                    Seu navegador n√£o suporta v√≠deos.
                                </video>
                                <div class="video-overlay"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="feature-card rounded-xl p-6 shadow-lg border-l-4 border-violet-500">
                        <div class="flex items-center mb-4">
                            <div class="bg-violet-100 p-3 rounded-lg mr-4">
                                <svg class="w-6 h-6 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                </svg>
                            </div>
                            <h3 class="text-xl font-bold text-gray-800">M√©todo LEPEBES</h3>
                        </div>
                        <p class="text-gray-600">Estruture seu racioc√≠nio com: <strong>Ler, Entender, Portugu√™s, Estrutura, Britney, Esqueleto</strong>.</p>
                    </div>

                    <div class="feature-card rounded-xl p-6 shadow-lg border-l-4 border-blue-500">
                        <div class="flex items-center mb-4">
                            <div class="bg-blue-100 p-3 rounded-lg mr-4">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <h3 class="text-xl font-bold text-gray-800">IA Pedag√≥gica</h3>
                        </div>
                        <p class="text-gray-600">Feedback que identifica o tipo de erro e sugere corre√ß√µes personalizadas. Oops, I will do it again.</p>
                    </div>

                    <div class="feature-card rounded-xl p-6 shadow-lg border-l-4 border-green-500">
                        <div class="flex items-center mb-4">
                            <div class="bg-green-100 p-3 rounded-lg mr-4">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-xl font-bold text-gray-800">Progresso Visual</h3>
                        </div>
                        <p class="text-gray-600">Monitore seu progresso com estat√≠sticas detalhadas de cada t√≥pico. Got you on my radar...</p>
                    </div>
                </div>

                <div class="bg-violet-50 border-l-4 border-violet-500 rounded-lg p-6 mb-6">
                    <h3 class="font-bold text-violet-900 mb-4 text-lg">üöÄ A√ß√µes R√°pidas</h3>
                    <div class="grid sm:grid-cols-3 gap-4">
                        <button onclick="app.setActiveTab('exemplo')" class="quick-action-btn bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-6 rounded-lg transition-all text-left">
                            <div class="flex items-center">
                                <span class="text-2xl mr-4">üìñ</span>
                                <div>
                                    <div class="font-bold text-lg">Ver Exemplo</div>
                                    <div class="text-sm opacity-90">Aprenda o m√©todo passo a passo</div>
                                </div>
                            </div>
                        </button>

                        <button onclick="app.setActiveTab('trilha')" class="quick-action-btn bg-violet-600 hover:bg-violet-700 text-white font-bold py-4 px-6 rounded-lg transition-all text-left">
                            <div class="flex items-center">
                                <span class="text-2xl mr-4">üìö</span>
                                <div>
                                    <div class="font-bold text-lg">Trilha de Estudos</div>
                                    <div class="text-sm opacity-90">Exerc√≠cios personalizados</div>
                                </div>
                            </div>
                        </button>
                        
                        <button onclick="app.setActiveTab('pratica')" class="quick-action-btn bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-lg transition-all text-left">
                            <div class="flex items-center">
                                <span class="text-2xl mr-4">üíª</span>
                                <div>
                                    <div class="font-bold text-lg">Praticar</div>
                                    <div class="text-sm opacity-90">Use o LEPEBES agora</div>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">üí° Como Funciona o M√©todo LEPEBES?</h3>
                    <div class="grid md:grid-cols-6 gap-4">
                        <div class="text-center p-4 bg-violet-50 rounded-lg">
                            <div class="lepees-label mx-auto mb-2">L</div>
                            <h4 class="font-bold text-sm">Ler</h4>
                            <p class="text-xs text-gray-600">o problema</p>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="lepees-label mx-auto mb-2" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color: #1d4ed8;">E</div>
                            <h4 class="font-bold text-sm">Entender</h4>
                            <p class="text-xs text-gray-600">entradas/sa√≠das</p>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="lepees-label mx-auto mb-2" style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); color: #166534;">P</div>
                            <h4 class="font-bold text-sm">Portugu√™s</h4>
                            <p class="text-xs text-gray-600">pseudoc√≥digo</p>
                        </div>
                        <div class="text-center p-4 bg-yellow-50 rounded-lg">
                            <div class="lepees-label mx-auto mb-2" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); color: #92400e;">E</div>
                            <h4 class="font-bold text-sm">Estrutura</h4>
                            <p class="text-xs text-gray-600">vari√°veis/loops</p>
                        </div>
                        <div class="text-center p-4 bg-pink-50 rounded-lg">
                            <div class="lepees-label mx-auto mb-2" style="background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); color: #831843;">B</div>
                            <h4 class="font-bold text-sm">Britney Spears</h4>
                            <p class="text-xs text-gray-600">oh, baby, baby...</p>
                        </div>
                        <div class="text-center p-4 bg-red-50 rounded-lg">
                            <div class="lepees-label mx-auto mb-2" style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); color: #991b1b;">Es</div>
                            <h4 class="font-bold text-sm">Esqueleto</h4>
                            <p class="text-xs text-gray-600">c√≥digo em C</p>
                        </div>
                    </div>
                </div>

                <div class="bg-orange-50 border-l-4 border-orange-500 rounded-lg p-6">
                    <h3 class="font-bold text-orange-900 mb-3 text-lg">üîß Ambiente de Desenvolvimento</h3>
                    <p class="text-orange-800 mb-4">Compile e teste seus c√≥digos diretamente no Google Colab.</p>
                    <a href="https://colab.research.google.com/" target="_blank" class="inline-flex items-center bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path>
                        </svg>
                        Abrir Google Colab
                    </a>
                </div>
            `;

            setTimeout(() => {
                const video = document.getElementById('hero-video');
                if (video) {
                    video.play().catch(err => {
                        console.log('Autoplay bloqueado. Mostrando poster da Britney.');
                    });

                    video.addEventListener('click', () => {
                        if (video.muted) {
                            video.muted = false;
                            video.volume = 0.5;
                        }
                    });

                    video.addEventListener('mouseenter', () => {
                        if (video.muted && !video.paused) {
                            video.title = 'Clique para ativar o √°udio';
                        }
                    });
                }
            }, 500);
        },

        render_trilha() {
             const renderTopicList = (title, topics) => `
                <div>
                    <h3 class="text-xl font-bold text-gray-800 mb-3">${title}</h3>
                    <div class="grid gap-3">
                        ${topics.map(topic => this.renderTopicCard(topic)).join('')}
                    </div>
                </div>`;
            
            this.elements.views.trilha.innerHTML = `
                <div id="loading-exercise" class="hidden bg-blue-50 border-2 border-blue-500 rounded-lg p-4 items-center gap-3">
                    <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
                    <div>
                        <p class="font-bold text-blue-900">Gerando exerc√≠cio personalizado...</p>
                        <p class="text-sm text-blue-700">A IA est√° criando um desafio para voc√™. Aguarde!</p>
                    </div>
                </div>
                ${renderTopicList('Conte√∫do P1 (Nivelamento)', this.topics.p1)}
                ${renderTopicList('Conte√∫do P2 (Foco Principal)', this.topics.p2)}
            `;
            
            this.elements.views.trilha.querySelectorAll('.practice-button').forEach(button => {
                button.addEventListener('click', (e) => this.generateExercise(e.currentTarget.dataset.topic));
            });
        },
        
        renderTopicCard(topic) {
            const progress = this.progressData[topic.id] || 0;
            const colors = {
                alta: { border: 'border-red-200', bg: 'bg-red-500', button: 'bg-red-500 hover:bg-red-600' },
                critica: { border: 'border-violet-200', bg: 'bg-violet-500', button: 'bg-violet-500 hover:bg-violet-600' }
            };
            const color = colors[topic.urgencia] || colors.alta;

            return `
                <div class="bg-white border-2 ${color.border} rounded-lg p-4">
                    <div class="flex items-center justify-between flex-wrap gap-3">
                        <div class="flex-1">
                            <h4 class="font-bold text-gray-800">${topic.nome}</h4>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                <div class="${color.bg} h-2 rounded-full transition-all duration-500" style="width: ${progress}%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">${progress}%</p>
                        </div>
                        <button data-topic="${topic.nome}" class="practice-button ${color.button} text-white px-4 py-2 rounded-lg flex items-center gap-2 min-w-[120px] justify-center">
                            Praticar
                        </button>
                    </div>
                </div>`;
        },

        render_pratica() {
            this.elements.views.pratica.innerHTML = `
                <div class="bg-white border-2 border-gray-200 rounded-lg p-4">
                    <label class="block font-bold text-gray-800 mb-2">üìù Enunciado do Exerc√≠cio:</label>
                    <textarea id="exercise-input" placeholder="Cole o enunciado aqui ou gere um na aba Trilha..." class="w-full h-24 p-3 border rounded-lg focus:ring-2 focus:ring-violet-500 modern-input"></textarea>
                </div>

                <div class="bg-white border-2 border-gray-200 rounded-lg p-4 space-y-4">
                    <h3 class="text-xl font-bold text-gray-800">Seu Planejamento (LEPEBES)</h3>
                    <div id="lepees-fields" class="space-y-4">${this.renderLepeesFields()}</div>
                    <button id="analyze-plan-button" class="w-full modern-button text-white font-bold py-3 rounded-lg flex items-center justify-center gap-2">Analisar Plano</button>
                </div>
                
                <div class="bg-white border-2 border-gray-200 rounded-lg p-4">
                    <label class="block font-bold text-gray-800 mb-2">üíª Seu C√≥digo C:</label>
                    <textarea id="code-input" placeholder="Ap√≥s a an√°lise do plano, escreva seu c√≥digo aqui... I need to make mistakes just to learn who I am" class="w-full h-56 p-3 border rounded-lg focus:ring-2 focus:ring-violet-500 font-mono text-sm modern-input"></textarea>
                </div>
                <button id="analyze-code-button" class="w-full bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-700 hover:to-indigo-700 text-white font-bold py-4 rounded-lg flex items-center justify-center gap-3 text-lg transition-all">Analisar C√≥digo</button>
                
                <div id="feedback-container" class="space-y-4 mt-6"></div>
                <div id="next-step-container" class="hidden mt-6 bg-white border-2 border-gray-200 rounded-lg p-4 space-y-4"></div>
                <div id="chat-container" class="hidden mt-6 bg-white border-2 border-gray-200 rounded-lg p-4 space-y-4">
                    <h3 class="text-lg font-bold text-gray-800">Converse sobre o Feedback</h3>
                    <div id="chat-messages" class="flex flex-col gap-2 h-48 overflow-y-auto p-2 border rounded-md bg-gray-50"></div>
                    <div class="flex gap-2">
                        <input type="text" id="chat-input" placeholder="Tire sua d√∫vida sobre a an√°lise..." class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-violet-500 modern-input">
                        <button id="chat-send-button" class="modern-button text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center">Enviar</button>
                    </div>
                </div>
            `;
            document.getElementById('analyze-plan-button').addEventListener('click', () => this.analyzePlan());
            document.getElementById('analyze-code-button').addEventListener('click', () => this.analyzeCode());
            document.getElementById('chat-send-button').addEventListener('click', () => this.sendChatMessage());
            document.getElementById('chat-input').addEventListener('keydown', (e) => { if (e.key === 'Enter') this.sendChatMessage(); });
        },

        renderLepeesFields() {
            return this.lepeesSteps.map(step => {
                if (step.type === 'checkbox') {
                    return `<div class="flex items-center gap-4">
                                <span class="lepees-label">${step.label}</span>
                                <div class="w-full flex items-center bg-white p-3 rounded-lg border border-gray-200">
                                    <input id="lepees-${step.id}" type="checkbox" class="h-5 w-5 rounded text-violet-600 focus:ring-violet-500">
                                    <label for="lepees-${step.id}" class="ml-3 block font-bold text-gray-700">${step.title}</label>
                                </div>
                            </div>`;
                } else {
                    return `<div class="flex items-start gap-4">
                                <span class="lepees-label">${step.label}</span>
                                <div class="w-full">
                                    <label class="block font-bold text-gray-700 mb-1">${step.title}</label>
                                    <textarea id="lepees-${step.id}" class="w-full h-20 p-2 border rounded-lg focus:ring-2 focus:ring-violet-500 modern-input"></textarea>
                                </div>
                            </div>`;
                }
            }).join('');
        },
        
        render_progresso() {
            const allTopics = [...this.topics.p1, ...this.topics.p2];
            
            // Calcular estat√≠sticas
            const totalTopics = allTopics.length;
            const progressValues = allTopics.map(t => this.progressData[t.id] || 0);
            const averageProgress = Math.round(progressValues.reduce((a, b) => a + b, 0) / totalTopics);
            const completedTopics = progressValues.filter(p => p === 100).length;
            const inProgressTopics = progressValues.filter(p => p > 0 && p < 100).length;
            const notStartedTopics = progressValues.filter(p => p === 0).length;
            
            // Encontrar melhor e pior t√≥pico
            const maxProgress = Math.max(...progressValues);
            const minProgress = Math.min(...progressValues.filter(p => p > 0));
            const bestTopic = allTopics.find(t => (this.progressData[t.id] || 0) === maxProgress);
            const weakestTopic = allTopics.find(t => (this.progressData[t.id] || 0) === minProgress && minProgress > 0);
            
            this.elements.views.progresso.innerHTML = `
                <!-- Header do Dashboard -->
                <div class="bg-gradient-to-r from-violet-600 to-indigo-600 text-white rounded-xl p-6 mb-6">
                    <h2 class="text-3xl font-bold mb-2">üìä Seu Progresso</h2>
                    <p class="text-lg opacity-90">Acompanhe sua evolu√ß√£o no m√©todo LEPEBES</p>
                </div>

                <!-- Cards de Estat√≠sticas -->
                <div class="grid md:grid-cols-4 gap-4 mb-6">
                    <!-- Card 1: Progresso Geral -->
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-violet-500">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 font-semibold">Progresso Geral</span>
                            <span class="text-3xl">üìà</span>
                        </div>
                        <div class="text-4xl font-bold text-violet-600">${averageProgress}%</div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-3">
                            <div class="bg-gradient-to-r from-violet-500 to-indigo-500 h-2 rounded-full transition-all duration-500" style="width: ${averageProgress}%"></div>
                        </div>
                    </div>

                    <!-- Card 2: T√≥picos Completos -->
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 font-semibold">Completos</span>
                            <span class="text-3xl">‚úÖ</span>
                        </div>
                        <div class="text-4xl font-bold text-green-600">${completedTopics}</div>
                        <div class="text-sm text-gray-500 mt-1">de ${totalTopics} t√≥picos</div>
                    </div>

                    <!-- Card 3: Em Progresso -->
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-yellow-500">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 font-semibold">Em Progresso</span>
                            <span class="text-3xl">üîÑ</span>
                        </div>
                        <div class="text-4xl font-bold text-yellow-600">${inProgressTopics}</div>
                        <div class="text-sm text-gray-500 mt-1">t√≥picos ativos</div>
                    </div>

                    <!-- Card 4: N√£o Iniciados -->
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-gray-400">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600 font-semibold">N√£o Iniciados</span>
                            <span class="text-3xl">‚è∏Ô∏è</span>
                        </div>
                        <div class="text-4xl font-bold text-gray-600">${notStartedTopics}</div>
                        <div class="text-sm text-gray-500 mt-1">aguardando</div>
                    </div>
                </div>

                <!-- Destaques -->
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <!-- Ponto Forte -->
                    ${bestTopic && maxProgress > 0 ? `
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-4xl">üí™</span>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Seu Ponto Forte</h3>
                                <p class="text-sm text-gray-600">Continue assim!</p>
                            </div>
                        </div>
                        <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                            <p class="font-bold text-green-900 text-lg">${bestTopic.nome}</p>
                            <div class="flex items-center gap-2 mt-2">
                                <div class="flex-1 bg-green-200 rounded-full h-3">
                                    <div class="bg-green-500 h-3 rounded-full" style="width: ${maxProgress}%"></div>
                                </div>
                                <span class="font-bold text-green-700">${maxProgress}%</span>
                            </div>
                        </div>
                    </div>
                    ` : `
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-4xl">üí™</span>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Seu Ponto Forte</h3>
                                <p class="text-sm text-gray-600">Ainda n√£o come√ßou</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 border-l-4 border-gray-300 p-4 rounded text-center">
                            <p class="text-gray-600">Resolva exerc√≠cios para ver suas conquistas!</p>
                        </div>
                    </div>
                    `}

                    <!-- Ponto Fraco -->
                    ${weakestTopic && minProgress > 0 ? `
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-4xl">üéØ</span>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Foco de Melhoria</h3>
                                <p class="text-sm text-gray-600">Pratique mais este t√≥pico</p>
                            </div>
                        </div>
                        <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
                            <p class="font-bold text-orange-900 text-lg">${weakestTopic.nome}</p>
                            <div class="flex items-center gap-2 mt-2">
                                <div class="flex-1 bg-orange-200 rounded-full h-3">
                                    <div class="bg-orange-500 h-3 rounded-full" style="width: ${minProgress}%"></div>
                                </div>
                                <span class="font-bold text-orange-700">${minProgress}%</span>
                            </div>
                            <button onclick="app.setActiveTab('trilha')" class="mt-3 w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                                Praticar Agora
                            </button>
                        </div>
                    </div>
                    ` : `
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-4xl">üéØ</span>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">Foco de Melhoria</h3>
                                <p class="text-sm text-gray-600">Continue praticando</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 border-l-4 border-gray-300 p-4 rounded text-center">
                            <p class="text-gray-600">Resolva mais exerc√≠cios para identificar pontos fracos!</p>
                        </div>
                    </div>
                    `}
                </div>

                <!-- Lista Detalhada de T√≥picos -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">üìö Progresso por T√≥pico</h3>
                    
                    <!-- P1 -->
                    <div class="mb-6">
                        <h4 class="text-lg font-bold text-gray-700 mb-3 flex items-center gap-2">
                            <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm">P1</span>
                            Nivelamento
                        </h4>
                        <div class="space-y-3">
                            ${this.topics.p1.map(topic => {
                                const progress = this.progressData[topic.id] || 0;
                                let statusColor = 'gray';
                                let statusIcon = '‚è∏Ô∏è';
                                let statusText = 'N√£o iniciado';
                                
                                if (progress === 100) {
                                    statusColor = 'green';
                                    statusIcon = '‚úÖ';
                                    statusText = 'Completo';
                                } else if (progress >= 75) {
                                    statusColor = 'blue';
                                    statusIcon = 'üîµ';
                                    statusText = 'Quase l√°';
                                } else if (progress >= 50) {
                                    statusColor = 'yellow';
                                    statusIcon = 'üü°';
                                    statusText = 'Progredindo';
                                } else if (progress > 0) {
                                    statusColor = 'orange';
                                    statusIcon = 'üü†';
                                    statusText = 'Iniciado';
                                }
                                
                                return `
                                    <div class="bg-gray-50 rounded-lg p-4 hover:shadow-md transition-shadow">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center gap-3">
                                                <span class="text-2xl">${statusIcon}</span>
                                                <div>
                                                    <h5 class="font-bold text-gray-800">${topic.nome}</h5>
                                                    <span class="text-xs text-${statusColor}-600 font-semibold">${statusText}</span>
                                                </div>
                                            </div>
                                            <span class="text-2xl font-bold text-${statusColor}-600">${progress}%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-${statusColor}-400 to-${statusColor}-600 h-3 rounded-full transition-all duration-500" style="width: ${progress}%"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- P2 -->
                    <div>
                        <h4 class="text-lg font-bold text-gray-700 mb-3 flex items-center gap-2">
                            <span class="bg-violet-100 text-violet-800 px-3 py-1 rounded-full text-sm">P2</span>
                            Foco Principal
                        </h4>
                        <div class="space-y-3">
                            ${this.topics.p2.map(topic => {
                                const progress = this.progressData[topic.id] || 0;
                                let statusColor = 'gray';
                                let statusIcon = '‚è∏Ô∏è';
                                let statusText = 'N√£o iniciado';
                                
                                if (progress === 100) {
                                    statusColor = 'green';
                                    statusIcon = '‚úÖ';
                                    statusText = 'Completo';
                                } else if (progress >= 75) {
                                    statusColor = 'blue';
                                    statusIcon = 'üîµ';
                                    statusText = 'Quase l√°';
                                } else if (progress >= 50) {
                                    statusColor = 'yellow';
                                    statusIcon = 'üü°';
                                    statusText = 'Progredindo';
                                } else if (progress > 0) {
                                    statusColor = 'orange';
                                    statusIcon = 'üü†';
                                    statusText = 'Iniciado';
                                }
                                
                                return `
                                    <div class="bg-gray-50 rounded-lg p-4 hover:shadow-md transition-shadow">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center gap-3">
                                                <span class="text-2xl">${statusIcon}</span>
                                                <div>
                                                    <h5 class="font-bold text-gray-800">${topic.nome}</h5>
                                                    <span class="text-xs text-${statusColor}-600 font-semibold">${statusText}</span>
                                                </div>
                                            </div>
                                            <span class="text-2xl font-bold text-${statusColor}-600">${progress}%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-3">
                                            <div class="bg-gradient-to-r from-${statusColor}-400 to-${statusColor}-600 h-3 rounded-full transition-all duration-500" style="width: ${progress}%"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>

                <!-- Motiva√ß√£o -->
                <div class="bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-xl p-6 mt-6 text-center">
                    <span class="text-5xl mb-3 block">üßë‚Äçüíª</span>
                    <h3 class="text-2xl font-bold mb-2">Continue assim!</h3>
                    <p class="text-lg opacity-90">
                        ${averageProgress === 0 ? 'Comece sua jornada agora! Na sua idade, Britney Spears j√° era milion√°ria! üíú' : 
                          averageProgress < 50 ? 'You want a hot body? You want a Bugatti? You want a Maserati? You better work, bitch ‚Ä¶' :
                          averageProgress < 100 ? 'Stronger than yesterday!' :
                          'IT IS BRITNEY, B*TCH! Voc√™ dominou tudo! Just like a circus! üé™'}
                    </p>
                </div>
            `;
        },

        renderFeedback(htmlContent, color = 'gray') {
            const container = document.getElementById('feedback-container');
            if(container) {
                const card = document.createElement('div');
                card.className = `border-l-4 p-4 rounded bg-${color}-50 border-${color}-500 prose max-w-none`;
                card.innerHTML = htmlContent;
                container.innerHTML = '';
                container.appendChild(card);
            }
        },

        addChatMessage(message, role) {
            const chatMessages = document.getElementById('chat-messages');
            if(chatMessages) {
                const bubble = document.createElement('div');
                bubble.className = `chat-bubble ${role}`;
                const converter = new showdown.Converter();
                bubble.innerHTML = converter.makeHtml(message);
                chatMessages.appendChild(bubble);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        },

        renderNextStep(assessment) {
            const container = document.getElementById('next-step-container');
            if (!container) return;

            container.innerHTML = '';
            container.classList.remove('hidden');

            const messageEl = document.createElement('p');
            messageEl.className = 'text-center font-medium text-gray-700';
            messageEl.textContent = assessment.message;
            container.appendChild(messageEl);
            
            if (assessment.nextAction === 'REDO') {
                const redoButton = document.createElement('button');
                redoButton.className = 'w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors';
                redoButton.textContent = 'Ok, vou tentar corrigir!';
                redoButton.onclick = () => container.classList.add('hidden');
                container.appendChild(redoButton);
            } else {
                 const btn_reinforce = document.createElement('button');
                 btn_reinforce.className = 'w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-colors';
                 btn_reinforce.textContent = 'Gerar Exerc√≠cio Similar';
                 btn_reinforce.onclick = () => this.generateExercise(assessment.topicName, 'normal');
                 container.appendChild(btn_reinforce);

                if (assessment.nextAction === 'PROCEED') {
                    const btn_proceed = document.createElement('button');
                    btn_proceed.className = 'w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg mt-2 transition-colors';
                    btn_proceed.textContent = 'Gerar Pr√≥ximo Exerc√≠cio (N√≠vel Acima)';
                    btn_proceed.onclick = () => this.generateExercise(assessment.topicName, 'hard');
                    container.appendChild(btn_proceed);
                }
            }
        },
        
        async callApi(endpoint, body) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 45000);
                
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body),
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Erro HTTP ${response.status}`);
                }
                
                const result = await response.json();
                return result;
            } catch (error) {
                console.error(`Erro na chamada da API para ${endpoint}:`, error);
                
                let errorMessage = 'Erro desconhecido';
                if (error.name === 'AbortError') {
                    errorMessage = 'Timeout: A requisi√ß√£o demorou muito para responder.';
                } else if (error.message) {
                    errorMessage = error.message;
                }
                
                alert(`Ocorreu um erro: ${errorMessage}. Tente novamente.`);
                return null;
            }
        },

        async generateExercise(topicName, difficulty = 'normal') {
            const button = document.querySelector(`.practice-button[data-topic="${topicName}"]`);
            if (button) this.setLoading(button, true, 'Gerando...');
            
            const nextStepContainer = document.getElementById('next-step-container');
            if (nextStepContainer) {
                nextStepContainer.innerHTML = `<div class="text-center font-bold">Gerando novo exerc√≠cio...</div>`;
            }

            const data = await this.callApi('/api/generate-exercise', { topicName, difficulty });

            if (button) this.setLoading(button, false);

            if (data) {
                const feedbackContainer = document.getElementById('feedback-container');
                const chatContainer = document.getElementById('chat-container');
                if (feedbackContainer) feedbackContainer.innerHTML = '';
                if (chatContainer) chatContainer.classList.add('hidden');
                if (nextStepContainer) nextStepContainer.classList.add('hidden');
                
                this.conversationHistory = [];
                this.setActiveTab('pratica');
                
                setTimeout(() => {
                    const exerciseInput = document.getElementById('exercise-input');
                    const codeInput = document.getElementById('code-input');
                    
                    if (exerciseInput) exerciseInput.value = data.enunciado || '';
                    if (codeInput) codeInput.value = data.prototipo || '';
                    
                    this.lepeesSteps.forEach(step => {
                        const el = document.getElementById(`lepees-${step.id}`);
                        if (el) {
                           if (step.type === 'checkbox') el.checked = false;
                           else el.value = '';
                        }
                    });
                }, 100);
            }
        },

        async analyzePlan() {
             const button = document.getElementById('analyze-plan-button');
             if (!button) return;
             
             this.setLoading(button, true, 'Analisando Plano...');
             
             const exerciseInput = document.getElementById('exercise-input');
             if (!exerciseInput) {
                 alert('Elemento n√£o encontrado. Recarregue a p√°gina.');
                 this.setLoading(button, false);
                 return;
             }
             
             const exercise = exerciseInput.value.trim();
             if (!exercise) {
                 alert('Por favor, cole o enunciado do exerc√≠cio primeiro.');
                 this.setLoading(button, false);
                 return;
             }
             
             const lepeesData = this.lepeesSteps.reduce((acc, step) => {
                 const el = document.getElementById(`lepees-${step.id}`);
                 if (el) {
                     acc[step.id] = (step.type === 'checkbox') ? (el.checked ? "Sim, li o problema." : "N√£o marquei que li o problema.") : el.value.trim();
                 }
                 return acc;
             }, {});

             const data = await this.callApi('/api/analyze-plan', { exercise, lepeesData });
             this.setLoading(button, false);
             if (data) {
                 this.renderFeedback(data.feedbackHtml, data.readyToCode ? 'green' : 'yellow');
             }
        },

        async analyzeCode() {
            const button = document.getElementById('analyze-code-button');
            if (!button) return;
            
            this.setLoading(button, true, 'Analisando C√≥digo...');

            const exerciseInput = document.getElementById('exercise-input');
            const codeInput = document.getElementById('code-input');
            const chatContainer = document.getElementById('chat-container');
            const chatMessages = document.getElementById('chat-messages');
            const nextStepContainer = document.getElementById('next-step-container');
            
            if (!exerciseInput || !codeInput) {
                alert('Elementos n√£o encontrados. Recarregue a p√°gina.');
                this.setLoading(button, false);
                return;
            }

            if (this.conversationHistory.length === 0) {
                 if (chatContainer) chatContainer.classList.add('hidden');
                 if (chatMessages) chatMessages.innerHTML = '';
                 if (nextStepContainer) nextStepContainer.classList.add('hidden');
                 this.conversationHistory.push({ role: 'user', parts: [{ text: `Exerc√≠cio: "${exerciseInput.value.trim()}"` }] });
            }
            
            const userPrompt = `Meu c√≥digo (vers√£o atual):\n\`\`\`c\n${codeInput.value.trim()}\n\`\`\`\n\nPor favor, analise-o novamente.`;
            this.conversationHistory.push({ role: 'user', parts: [{ text: userPrompt }] });

            const data = await this.callApi('/api/analyze-code', { 
                exercise: exerciseInput.value.trim(), 
                code: codeInput.value.trim(),
                history: this.conversationHistory
            });
            this.setLoading(button, false);

            if (data) {
                this.conversationHistory.push({ role: 'model', parts: [{ text: JSON.stringify(data) }] });
                const isCorrect = data.assessment.nextAction !== 'REDO';
                this.renderFeedback(data.feedbackHtml, isCorrect ? 'green' : 'red');
                if (chatContainer) chatContainer.classList.remove('hidden');
                this.renderNextStep(data.assessment);

                if(isCorrect && data.assessment.topicId && this.progressData.hasOwnProperty(data.assessment.topicId)) {
                    this.progressData[data.assessment.topicId] = Math.min(100, (this.progressData[data.assessment.topicId] || 0) + 25);
                    this.saveProgress();
                }
            }
        },
        
        async sendChatMessage() {
            const chatInput = document.getElementById('chat-input');
            const chatSendButton = document.getElementById('chat-send-button');
            const userText = chatInput.value.trim();
            if(!userText) return;

            this.addChatMessage(userText, 'user');
            chatInput.value = '';
            chatInput.disabled = true;
            chatSendButton.disabled = true;

            this.conversationHistory.push({ role: 'user', parts: [{ text: userText }] });
            const data = await this.callApi('/api/chat', { history: this.conversationHistory });
            
            chatInput.disabled = false;
            chatSendButton.disabled = false;
            
            if(data) {
                this.conversationHistory.push({ role: 'model', parts: [{ text: data.replyHtml }] });
                this.addChatMessage(data.replyHtml, 'model');
            }
        }
    };

    window.app = app;
    app.init();
});
</script>
<footer>
  <p>¬© 2025 - Esta plataforma foi desenvolvida por gabrielhando com aux√≠lio de IA e n√£o tem fins lucrativos</p>
</footer>
<style>
  footer {
    width: 100%;           /* ocupa toda a largura */
    text-align: center;    /* centraliza o texto */
    font-size: 12px;       /* deixa menor */
    color: #777;           /* cinza discreto */
    background: #f9f9f9;   /* opcional: fundo claro */
    padding: 8px 0;        /* espa√ßo interno */
    border-top: 1px solid #ddd; /* linha separadora opcional */
  }
</style>
</body>
</html>
